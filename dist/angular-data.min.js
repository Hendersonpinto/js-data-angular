/**
* @author Jason Dobry <jason.dobry@gmail.com>
* @file angular-data.min.js
* @version 0.0.1-SNAPSHOT - Homepage <http://jmdobry.github.io/angular-data/>
* @copyright (c) 2014 Jason Dobry <http://jmdobry.github.io/angular-data>
* @license MIT <https://github.com/jmdobry/angular-data/blob/master/LICENSE>
*
* @overview In-browser data store for Angular.js.
*/
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b){return-1!==d(a,b)}var d=a("./indexOf");b.exports=c},{"./indexOf":3}],2:[function(a,b){function c(a,b,c){b=d(b,c);var e=[];if(null==a)return e;for(var f,g=-1,h=a.length;++g<h;)f=a[g],b(f,g,a)&&e.push(f);return e}var d=a("../function/makeIterator_");b.exports=c},{"../function/makeIterator_":8}],3:[function(a,b){function c(a,b,c){if(c=c||0,null==a)return-1;for(var d=a.length,e=0>c?d+c:c;d>e;){if(a[e]===b)return e;e++}return-1}b.exports=c},{}],4:[function(a,b){function c(a,b,c){return d.call(a,b,c)}var d=Array.prototype.slice;b.exports=c},{}],5:[function(a,b){function c(a,b){if(null==a)return[];if(a.length<2)return a;null==b&&(b=d);var f,g,h;return f=~~(a.length/2),g=c(a.slice(0,f),b),h=c(a.slice(f,a.length),b),e(g,h,b)}function d(a,b){return b>a?-1:a>b?1:0}function e(a,b,c){for(var d=[];a.length&&b.length;)c(a[0],b[0])<=0?d.push(a.shift()):d.push(b.shift());return a.length&&d.push.apply(d,a),b.length&&d.push.apply(d,b),d}b.exports=c},{}],6:[function(a,b){function c(a,b){var c={};if(null==a)return c;var e,f=-1,g=a.length;if(d(b))for(;++f<g;)e=a[f],c[b(e)]=e;else for(;++f<g;)e=a[f],c[e[b]]=e;return c}var d=a("../lang/isFunction");b.exports=c},{"../lang/isFunction":11}],7:[function(a,b){function c(a){return a}b.exports=c},{}],8:[function(a,b){function c(a,b){if(null==a)return d;switch(typeof a){case"function":return"undefined"!=typeof b?function(c,d,e){return a.call(b,c,d,e)}:a;case"object":return function(b){return f(b,a)};case"string":case"number":return e(a)}}var d=a("./identity"),e=a("./prop"),f=a("../object/deepMatches");b.exports=c},{"../object/deepMatches":16,"./identity":7,"./prop":9}],9:[function(a,b){function c(a){return function(b){return b[a]}}b.exports=c},{}],10:[function(a,b){var c=a("./isKind"),d=Array.isArray||function(a){return c(a,"Array")};b.exports=d},{"./isKind":12}],11:[function(a,b){function c(a){return d(a,"Function")}var d=a("./isKind");b.exports=c},{"./isKind":12}],12:[function(a,b){function c(a,b){return d(a)===b}var d=a("./kindOf");b.exports=c},{"./kindOf":14}],13:[function(a,b){function c(a){return!!a&&"object"==typeof a&&a.constructor===Object}b.exports=c},{}],14:[function(a,b){function c(a){return null===a?"Null":a===d?"Undefined":e.exec(f.call(a))[1]}var d,e=/^\[object (.*)\]$/,f=Object.prototype.toString;b.exports=c},{}],15:[function(a,b){function c(a){return null==a?"":a.toString()}b.exports=c},{}],16:[function(a,b){function c(a,b){for(var c=-1,d=a.length;++c<d;)if(f(a[c],b))return!0;return!1}function d(a,b){for(var d=-1,e=b.length;++d<e;)if(!c(a,b[d]))return!1;return!0}function e(a,b){var c=!0;return g(b,function(b,d){return f(a[d],b)?void 0:c=!1}),c}function f(a,b){return a&&"object"==typeof a?h(a)&&h(b)?d(a,b):e(a,b):a===b}var g=a("./forOwn"),h=a("../lang/isArray");b.exports=f},{"../lang/isArray":10,"./forOwn":19}],17:[function(a,b){function c(a){for(var b,c=0,f=arguments.length;++c<f;)b=arguments[c],b&&e(b,d,a);return a}function d(a,b){var d=this[b];f(a)&&f(d)?c(d,a):this[b]=a}var e=a("./forOwn"),f=a("../lang/isPlainObject");b.exports=c},{"../lang/isPlainObject":13,"./forOwn":19}],18:[function(a,b){function c(){g=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=!0;for(var a in{toString:null})f=!1}function d(a,b,d){var h,i=0;null==f&&c();for(h in a)if(e(b,a,h,d)===!1)break;if(f)for(;(h=g[i++])&&(a[h]===Object.prototype[h]||e(b,a,h,d)!==!1););}function e(a,b,c,d){return a.call(d,b[c],c,b)}var f,g;b.exports=d},{}],19:[function(a,b){function c(a,b,c){e(a,function(e,f){return d(a,f)?b.call(c,a[f],f,a):void 0})}var d=a("./hasOwn"),e=a("./forIn");b.exports=c},{"./forIn":18,"./hasOwn":20}],20:[function(a,b){function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}b.exports=c},{}],21:[function(a,b){function c(a){return a=d(a),a.toUpperCase()}var d=a("../lang/toString");b.exports=c},{"../lang/toString":15}],22:[function(a,b){function c(a,b,c){for(var d=a[c],e=b(d);c>0;){var f=Math.floor((c+1)/2)-1,g=a[f];if(e>=b(g))break;a[f]=d,a[c]=g,c=f}}function d(a,b,c){for(var d=a.length,e=a[c],f=b(e);;){var g=2*(c+1),h=g-1,i=null;if(d>h){var j=a[h],k=b(j);f>k&&(i=h)}if(d>g){var l=a[g],m=b(l);m<(null===i?f:b(a[h]))&&(i=g)}if(null===i)break;a[c]=a[i],a[i]=e,c=i}}function e(a){if(a&&"function"!=typeof a)throw new Error("BinaryHeap(weightFunc): weightFunc: must be a function!");a=a||function(a){return a},this.weightFunc=a,this.heap=[]}e.prototype.push=function(a){this.heap.push(a),c(this.heap,this.weightFunc,this.heap.length-1)},e.prototype.peek=function(){return this.heap[0]},e.prototype.pop=function(){var a=this.heap[0],b=this.heap.pop();return this.heap.length>0&&(this.heap[0]=b,d(this.heap,this.weightFunc,0)),a},e.prototype.remove=function(a){for(var b=this.heap.length,e=0;b>e;e++)if(angular.equals(this.heap[e],a)){var f=this.heap[e],g=this.heap.pop();return e!==b-1&&(this.heap[e]=g,c(this.heap,this.weightFunc,e),d(this.heap,this.weightFunc,e)),f}return null},e.prototype.removeAll=function(){this.heap=[]},e.prototype.size=function(){return this.heap.length},b.exports=e},{}],23:[function(a,b){function c(a,b){var c=(new Date).getTime();k.$http(b).success(function(b,d,e,f){k.$log.debug(f.method+" request:"+f.url+" Time taken: "+((new Date).getTime()-c)+"ms",arguments),a.resolve(b)}).error(function(b){k.$log.error(arguments),a.reject(b)})}function d(a){var b=k.$q.defer();try{k.$rootScope.$$phase?c(b,a):k.$rootScope.$apply(function(){c(b,a)})}catch(d){b.reject(new j.UnhandledError(d))}return b.promise}function e(a,b){return d(i.deepMixIn(b,{url:a,method:"GET"}))}function f(a,b,c){return d(i.deepMixIn(c,{url:a,data:b,method:"PUT"}))}function g(a,b,c){return d(i.deepMixIn(c,{url:a,data:b,method:"POST"}))}function h(a,b){return d(i.deepMixIn(b,{url:a,method:"DELETE"}))}var i=a("../../utils"),j=a("../../errors"),k=a("../services");b.exports={HTTP:d,GET:e,POST:g,PUT:f,DEL:h}},{"../../errors":37,"../../utils":39,"../services":35}],24:[function(a,b){function c(a){if(d.isString(a)&&(a={name:a}),!d.isObject(a))throw new e.IllegalArgumentError("DS.defineResource(definition): definition: Must be an object!",{definition:{actual:typeof a,expected:"object"}});if(!d.isString(a.name))throw new e.IllegalArgumentError("DS.defineResource(definition): definition.name: Must be a string!",{definition:{name:{actual:typeof a.name,expected:"string"}}});if(a.idAttribute&&!d.isString(a.idAttribute))throw new e.IllegalArgumentError("DS.defineResource(definition): definition.idAttribute: Must be a string!",{definition:{idAttribute:{actual:typeof a.idAttribute,expected:"string"}}});if(f[a.name])throw new e.RuntimeError("DS.defineResource(definition): "+a.name+" is already registered!");try{f[a.name]=a;var b=f[a.name];b.collection=[],b.completedQueries={},b.pendingQueries={},b.index={},b.modified={},b.collectionModified=0}catch(c){throw new e.UnhandledError(c)}}var d=a("../../utils"),e=a("../../errors"),f=a("../store");b.exports=c},{"../../errors":37,"../../utils":39,"../store":36}],25:[function(a,b){function c(a,b){var c=$q.defer();f[a]?d.isString(b)||d.isNumber(b)||c.reject(new e.IllegalArgumentError("DS.destroy(resourceName, id): id: Must be a string or a number!",{id:{actual:typeof b,expected:"string|number"}})):c.reject(new e.RuntimeError("DS.destroy(resourceName, id): "+a+" is not a registered resource!"));try{var g=f[a];this.DEL(g.baseUrl+"/"+(g.endpoint||a+"/"+b),null).then(function(){try{delete g.index[b],delete g.modified[b];for(var a=0;a<g.collection.length&&g.collection[a][g.idAttribute||"id"]!=b;a++);g.collection.splice(a,1),g.collectionModified=d.updateTimestamp(g.collectionModified),c.resolve(b)}catch(f){c.reject(new e.UnhandledError(f))}},c.reject)}catch(h){c.reject(new e.UnhandledError(h))}return c.promise}var d=a("../../utils"),e=a("../../errors"),f=a("../store");b.exports=c},{"../../errors":37,"../../utils":39,"../store":36}],26:[function(a,b){function c(a,b){for(var c=0;c<a.collection.length&&a.collection[c][a.idAttribute||"id"]!=b;c++);a.collection.splice(c,1),delete a.index[b],delete a.modified[b],a.collectionModified=e.updateTimestamp(a.collectionModified)}function d(a,b){if(!g[a])throw new f.RuntimeError("DS.eject(resourceName, id): "+a+" is not a registered resource!");if(!e.isString(b)&&!e.isNumber(b))throw new f.IllegalArgumentError("DS.eject(resourceName, id): id: Must be a string or a number!",{id:{actual:typeof b,expected:"string|number"}});try{h.$rootScope.$$phase?c(g[a],b):h.$rootScope.$apply(function(){c(g[a],b)})}catch(d){throw new f.UnhandledError(d)}}var e=a("../../utils"),f=a("../../errors"),g=a("../store"),h=a("../services");b.exports=d},{"../../errors":37,"../../utils":39,"../services":35,"../store":36}],27:[function(a,b){function c(a,b,c){if(!e[a])throw new Error("DS.filter(resourceName, params, loadFromServer): "+a+" is not a registered resource!");if(b&&!d.isObject(b))throw new Error("DS.filter(resourceName, params, loadFromServer): params: Must be an object!");var f=e[a];b=b||{},b.query=b.query||{};var g=d.toJson(b);if(g in f.completedQueries||!c){var h=d.filter(f.collection,function(a){var c=!0;return d.forOwn(b.query.criteria,function(b,e){-1!==e.indexOf(".")&&(e=e.split(".")[1]),b["=="]?c="null"==b["=="]?c&&null===a[e]:c&&a[e]==b["=="]:b["!="]?c=c&&a[e]!=b["!="]:b[">"]?c=c&&a[e]>b[">"]:b[">="]?c=c&&a[e]>=b[">="]:b["<"]?c=c&&a[e]<b["<"]:b["<="]?c=c&&a[e]<=b["<="]:b["in"]&&(c=c&&d.contains(b["in"],a[e]))}),c});return b.query.sort&&d.forOwn(b.query.sort,function(a,b){-1!==b.indexOf(".")&&(b=b.split(".")[1]),h=d.sort(h,function(c,e){var f=c[b],g=e[b];return d.isString(f)&&(f=d.upperCase(f)),d.isString(g)&&(g=d.upperCase(g)),"DESC"===a?f>g?-1:g>f?1:0:g>f?-1:f>g?1:0})}),d.isNumber(b.query.limit)&&d.isNumber(b.query.offset)?h=d.slice(h,b.query.offset,b.query.offset+b.query.limit):d.isNumber(b.query.limit)?h=d.slice(h,0,b.query.limit):d.isNumber(b.query.offset)&&(h=d.slice(h,b.query.offset)),h}return f.pendingQueries[g]||this.findAll(a,b),[]}var d=a("../../utils"),e=(a("../../errors"),a("../store"));b.exports=c},{"../../errors":37,"../../utils":39,"../store":36}],28:[function(a,b){function c(a,b,c){var h=$q.defer();f[a]?d.isString(b)||d.isNumber(b)||h.reject(new e.IllegalArgumentError("DS.find(resourceName, id[, forceRefresh]): id: Must be a string or a number!",{id:{actual:typeof b,expected:"string|number"}})):h.reject(new e.RuntimeError("DS.find(resourceName, id[, forceRefresh]): "+a+" is not a registered resource!"));try{var i=f[a];b in i.index&&!c?h.resolve(i.index[b]):g(i.baseUrl+"/"+(i.endpoint||a)+"/"+b,null).then(function(a){a&&(i.index[b]?d.deepMixIn(i.index[b],a):(i.index[b]=a,i.collection.push(i.index[b])),i.modified[b]=d.updateTimestamp(i.modified[b]),i.collectionModified=d.updateTimestamp(i.collectionModified)),h.resolve(i.index[b])},h.reject)}catch(j){h.reject(new e.UnhandledError(j))}return h.promise}var d=a("../../utils"),e=a("../../errors"),f=a("../store"),g=(a("../services"),a("../HTTP").GET);b.exports=c},{"../../errors":37,"../../utils":39,"../HTTP":23,"../services":35,"../store":36}],29:[function(a,b){function c(a,b,c){var d=h[b];a=a||[],delete d.pendingQueries[c],d.completedQueries[c]=(new Date).getTime();for(var e=[],g=0;g<a.length;g++)e.push(a[g]);d.collection=f.mergeArrays(d.collection,a,d.idAttribute||"id"),d.index=f.toLookup(d.collection,d.idAttribute||"id");for(var i=0;i<e.length;i++)d.modified[e[i][d.idAttribute||"id"]]=f.updateTimestamp(d.modified[e[i][d.idAttribute||"id"]]);return d.collectionModified=f.updateTimestamp(d.collectionModified),e}function d(a,b,d,e){var i=h[b];d.query=d.query||{};var k=f.toJson(d);e&&delete i.completedQueries[k],k in i.completedQueries?a.resolve(this.filter(b,d)):i.pendingQueries[k]||(i.pendingQueries[k]=j(i.baseUrl+"/"+(i.endpoint||b),{params:d}).then(function(d){try{a.resolve(c(d,b,k))}catch(e){a.reject(new g.UnhandledErrror(e))}},a.reject))}function e(a,b,c){var e=i.$q.defer();b=b||{},h[a]?f.isObject(b)||e.reject(new g.IllegalArgumentError("DS.findAll(resourceName[, params]): params: Must be an object!",{params:{actual:typeof b,expected:"object"}})):e.reject(new g.RuntimeError("DS.findAll(resourceName[, params]): "+a+" is not a registered resource!"));try{d.apply(this,[e,a,b,c])}catch(j){e.reject(new g.UnhandledErrror(j))}return e.promise}var f=a("../../utils"),g=a("../../errors"),h=a("../store"),i=a("../services"),j=a("../HTTP").GET;b.exports=e},{"../../errors":37,"../../utils":39,"../HTTP":23,"../services":35,"../store":36}],30:[function(a,b){function c(a,b){if(!f[a])throw new e.IllegalArgumentError("DS.get(resourceName, id): "+a+" is not a registered resource!");if(!d.isString(b)&&!d.isNumber(b))throw new e.IllegalArgumentError("DS.get(resourceName, id): id: Must be a string or a number!",{id:{actual:typeof b,expected:"string|number"}});try{return b in f[a].index||this.find(a,b),f[a].index[b]}catch(c){throw new e.UnhandledError(c)}}var d=a("../../utils"),e=a("../../errors"),f=a("../store");b.exports=c},{"../../errors":37,"../../utils":39,"../store":36}],31:[function(a,b){b.exports=a(23)},{"../../errors":37,"../../utils":39,"../services":35}],32:[function(a,b){function c(){this.$get=["$rootScope","$log","$http","$q",function(b,c,e,f){d.$rootScope=b,d.$log=c,d.$http=e,d.$q=f;var g=a("./http");return{HTTP:g.HTTP,GET:g.GET,POST:g.POST,PUT:g.PUT,DEL:g.DEL,defineResource:a("./defineResource"),destroy:a("./destroy"),eject:a("./eject"),filter:a("./filter"),findAll:a("./findAll"),find:a("./find"),get:a("./get"),inject:a("./inject"),lastModified:a("./lastModified")}}]}var d=a("./services");b.exports=c},{"./defineResource":24,"./destroy":25,"./eject":26,"./filter":27,"./find":28,"./findAll":29,"./get":30,"./http":31,"./inject":33,"./lastModified":34,"./services":35}],33:[function(a,b){function c(a,b){var c=a.idAttribute||"id";a.index[b[c]]?e.deepMixIn(a.index[b[c]],b):(a.index[b[c]]=b,a.collection.push(a.index[b[c]])),a.modified[b[c]]=e.updateTimestamp(a.modified[b[c]]),a.collectionModified=e.updateTimestamp(a.collectionModified)}function d(a,b){if(!g[a])throw new f.RuntimeError("DS.inject(resourceName, attrs): "+a+" is not a registered resource!");if(!e.isObject(b))throw new f.IllegalArgumentError("DS.inject(resourceName, attrs): attrs: Must be an object!",{attrs:{actual:typeof b,expected:"object"}});var d=g[a],i=d.idAttribute||"id";if(b[i]){try{h.$rootScope.$$phase?c(g[a],b):h.$rootScope.$apply(function(){c(g[a],b)})}catch(j){throw new f.UnhandledError(j)}return d.index[b[i]]}throw new f.RuntimeError("DS.inject(resourceName, attrs): attrs: Must contain the property specified by `idAttribute` in the resource definition!")}var e=a("../../utils"),f=a("../../errors"),g=a("../store"),h=a("../services");b.exports=d},{"../../errors":37,"../../utils":39,"../services":35,"../store":36}],34:[function(a,b){function c(a,b){if(!f[a])throw new e.RuntimeError("DS.lastModified(resourceName[, id]): "+a+" is not a registered resource!");if(b&&!d.isString(b)&&!d.isNumber(b))throw new e.IllegalArgumentError("DS.lastModified(resourceName[, id]): id: Must be a string or number!",{id:{actual:typeof b,expected:"string|number"}});try{return b?(b in f[a].modified||(f[a].modified[b]=0),f[a].modified[b]):f[a].collectionModified}catch(c){throw new e.UnhandledError(c)}}var d=a("../../utils"),e=a("../../errors"),f=a("../store");b.exports=c},{"../../errors":37,"../../utils":39,"../store":36}],35:[function(a,b){b.exports={}},{}],36:[function(a,b){b.exports={}},{}],37:[function(a,b){b.exports={UnhandledError:function(a){Error.call(this),Error.captureStackTrace(this,this.constructor),a=a||{},this.type=this.constructor.name,this.originalError=a,this.message="UnhandledError: This is an uncaught exception. Please consider submitting an issue at https://github.com/jmdobry/reheat/issues.\n\nOriginal Uncaught Exception:\n"+(a.stack?a.stack.toString():a.stack),this.stack=this.message},IllegalArgumentError:function(a,b){Error.call(this),Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.errors=b||{},this.message=a||"Illegal Argument!"},ValidationError:function(a,b){Error.call(this),Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.errors=b||{},this.message=a||"Validation Error!"},RuntimeError:function(a,b){Error.call(this),Error.captureStackTrace(this,this.constructor),this.type=this.constructor.name,this.errors=b||{},this.message=a||"RuntimeError Error!"}}},{}],38:[function(a){!function(b,c){"use strict";function d(){this.$get=function(){return a("./binaryHeap")}}c.module("jmdobry.binary-heap",[]),c.module("jmdobry.binary-heap").provider("BinaryHeap",d),c.module("jmdobry.angular-data",["ng","jmdobry.binary-heap"]),c.module("jmdobry.angular-data").provider("DS",a("./datastore"))}(window,window.angular)},{"./binaryHeap":22,"./datastore":32}],39:[function(a,b){b.exports={isString:angular.isString,isArray:angular.isArray,isObject:angular.isObject,isNumber:angular.isNumber,toJson:angular.toJson,upperCase:a("mout/string/upperCase"),deepMixIn:a("mout/object/deepMixIn"),forOwn:a("mout/object/forOwn"),contains:a("mout/array/contains"),filter:a("mout/array/filter"),toLookUp:a("mout/array/toLookup"),slice:a("mout/array/slice"),sort:a("mout/array/sort"),updateTimestamp:function(a){var b="function"==typeof Date.now?Date.now():(new Date).getTime();return a&&a>=b?a+1:b},mergeArrays:function(a,b,c){c=c||"id";for(var d=0;d<a.length;d++)for(var e=0;e<b.length;e++)if(a[d][c]==b[e][c]){angular.extend(a[d],b[e]),b.splice(e,1);break}return a.concat(b)}}},{"mout/array/contains":1,"mout/array/filter":2,"mout/array/slice":4,"mout/array/sort":5,"mout/array/toLookup":6,"mout/object/deepMixIn":17,"mout/object/forOwn":19,"mout/string/upperCase":21}]},{},[38]);